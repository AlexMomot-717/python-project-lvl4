{% extends "base.html" %}
{% block content %}
  {% load i18n %}
  {% load custom_filters %}
  <h1 class="my-4">{% translate "Tasks" %}</h1>
  <a class="btn btn-primary mb-3" href="/tasks/create/"
    >{% translate "Create task" %}</a
  >
  <div class="card mb-3">
    <div class="card-body bg-light">
<!--      <form class="form-inline center" method="get">-->
<!--        <div class="mb-3">-->
<!--        {{ filter.form.as_p }}-->
<!--        <input type="submit" />-->
<!--        </div>-->
<!--        </form>-->
    <form class="form-inline center" method="get">
      {% csrf_token %}
      <div class="mb-3">
        <label class="form-label" for="id_status">Статус</label>
        <select name="status" class="form-select ml-2 mr-3 is-valid" id="id_status">
          <option value="{{ None }}" selected="">---------</option>
          {% for status in statuses %}
          <option value="{{ status.id }}">{{ status }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label" for="id_executor">Исполнитель</label>
        <select name="executor" class="form-select mr-3 ml-2 is-valid" id="id_executor">
          <option value="{{ None }}">---------</option>
          {% for executor in executors %}
          <option value="{{ executor.id }}">{{ executor }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label" for="id_label">Метка</label>
        <select name="label" class="form-select mr-3 ml-2 is-valid" id="id_label">
          <option value="{{ None }}">---------</option>
          {% for label in labels %}
          <option value="{{ label.id }}">{{ label }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="mb-3">
        <div class="form-check">
          <input type="checkbox" name="self_tasks" class="form-check-input mr-3 is-valid" id="id_self_tasks">
          <label class="form-check-label" for="id_self_tasks">Только свои задачи</label>
        </div>
      </div>
        <input class="btn btn-primary" type="submit" value="Показать">
    </form>
    </div>
  </div>

  <table class="table table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>{% translate "Name" %}</th>
        <th>{% translate "Status" %}</th>
        <th>{% translate "Author" %}</th>
        <th>{% translate "Executor" %}</th>
        <th>{% translate "Creation date" %}</th>
        <th></th>
      </tr>
    </thead>
    {% if filter %}
      <tbody>
        {% for task in filter.qs %}
          <tr>
            <td>{{ task.id }}</td>
            <td>
              <a href="/tasks/{{ task.id }}/">{{ task.name }}</a>
            </td>
            <td>{{ task.status.name }}</td>
            <td>{{ task.author }}</td>
            {% if task.executor %}
              <td>{{ task.executor }}</td>
            {% else %}
              <td></td>
            {% endif %}
            <td>{{ task.created_at|format_datetime }}</td>
            <td>
              <a href="/tasks/{{ task.id }}/update/"
                >{% translate "Update" %}</a
              >
              <br />
              <a href="/tasks/{{ task.id }}/delete/"
                >{% translate "Delete" %}</a
              >
            </td>
          </tr>
        {% endfor %}
      </tbody>
    {% endif %}
  </table>
{% endblock %}
